{% extends "Book/base.html" %}
{% load socialaccount %}

{% block title %}Create account Â· Note-Book{% endblock %}

{% block content %}
  <section class="form-shell">
    <div class="form-card">
      <h1>Create your account</h1>
      <p>Use your email as your username.</p>
      {% if messages %}
        <div class="alert">
          {% for message in messages %}
            <p>{{ message }}</p>
          {% endfor %}
        </div>
      {% endif %}
      <form method="post" class="form-grid">
        {% csrf_token %}
        <div class="form-group">
          <label for="id_name">Name</label>
          <input id="id_name" name="name" type="text" autocomplete="name" required />
        </div>
        <div class="form-group">
          <label for="id_email">Email</label>
          <input id="id_email" name="username" type="email" autocomplete="email" required />
        </div>
        <div class="form-group">
          <label for="id_password">Password</label>
          <input id="id_password" name="password" type="password" autocomplete="new-password" required />
        </div>
        <input id="id_recaptcha_token" name="recaptcha_token" type="hidden" />
        <div class="form-actions">
          <button class="btn btn-primary" type="submit">Create account</button>
          <a class="btn btn-ghost" href="/accounts/login/">Already have an account?</a>
        </div>
      </form>
      {% get_providers as socialaccount_providers %}
      {% if socialaccount_providers %}
        <div class="divider">
          <span>or continue with</span>
        </div>
        <div class="social-actions">
          {% for provider in socialaccount_providers %}
          {% if provider.id == "google" %}
            <a class="btn btn-ghost" href="{% provider_login_url provider.id %}?prompt=consent">Google</a>
          {% endif %}
            {% if provider.id == "apple" %}
              <a class="btn btn-ghost" href="{% provider_login_url provider.id %}">Apple</a>
            {% endif %}
            {% if provider.id == "microsoft" %}
              <a class="btn btn-ghost" href="{% provider_login_url provider.id %}">Outlook</a>
            {% endif %}
          {% endfor %}
        </div>
      {% endif %}
    </div>
  </section>

  <script src="https://www.google.com/recaptcha/api.js?render={{ recaptcha_site_key }}"></script>
  <script>
    grecaptcha.ready(function () {
      grecaptcha.execute("{{ recaptcha_site_key }}", { action: "signup" }).then(function (token) {
        document.getElementById("id_recaptcha_token").value = token;
      });
    });
  </script>
{% endblock %}
